<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
 <html>
 	<head>
 		<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
 		<title>TSDS Generator</title>
 		<link rel="stylesheet" type="text/css" href="asset/main.css">
 		<link rel="icon" type="image/ico" href="asset/favicon.ico"/>
 		<script type="text/javascript" src="deps/async.js"></script>
 		
 		<script type="text/javascript" src="deps/1.7.2/jquery.min.js"></script>
 		<script type="text/javascript" src="deps/autosize/jquery.autosize-min.js"></script>
 		<script type="text/javascript" src="deps/strftime.js"></script>
 		<script type="text/javascript" src="deps/sprintf-0.7-beta1.js"></script>	
 		<script type="text/javascript" src="deps/date.js"></script>
 		<script type="text/javascript" src="deps/jquery.scrollTo-min.js"></script>

 		<script type="text/javascript" src="checkproxy.js"></script> 		
 		<script type="text/javascript" src="tsdsgen-default.js"></script>
 		<script type="text/javascript" src="tsdsgen.js"></script>
 	</head>
	<script>
		$(document).ready(function(){
			$('#CatalogName').val(CatalogDescription["Name"]);
			$('#CatalogID').val(CatalogDescription["ID"]);
			$('#CatalogDescription').val(CatalogDescription["Description"] || CatalogDescription["Name"]	);
			$('#Template').val(Template);
			$('#LineTemplate').val(LineTemplate);
			$('#LineRegex').val(LineRegex);
			$('#ColumnUnits').val(ColumnUnits);
			var tmp = JSON.stringify(DatasetDescription).replace(/\],\[/g,"\n").replace("[[","").replace("]]","").replace(/\"/g,"");
			//console.log(tmp)
			$('#Dataset').text(tmp);
			$('#ColumnLabels').val(JSON.stringify(ColumnLabels));
			$('#ColumnLongnames').val(JSON.stringify(ColumnLongnames));
			$('#ColumnGroupings').val(JSON.stringify(ColumnGroupings));
			$('#ColumnGroupnames').val(JSON.stringify(ColumnGroupnames));
			$('#ColumnGrouptypes').val(JSON.stringify(ColumnGrouptypes));

			$('#startmin').val(Start);
			$('#stopmax').val(Stop);
			
			$('input[type=button].try').click(
				function () {
					$(this).val('');						
					$(this).each(function() {expandtemplate(this)});
					links();
				});

			$('textarea.enter').autosize();

			if (0) {
				$('textarea.try').autosize();

				
				$("textarea.try").toggle(
								function () {
									$(this).trigger("oninput"); // Trigger autosize event.
								},	
								function () {
									$(this).height("5.5em")
								});
			}
				
			//setInterval(detectchange,500);
			setTimeout(
					function () {
						$('input[type=button].try').click();
						dlscript();
						//$('input[type=button].try').eq(5).click();
						// Create THREDDS catalog
						//catalog($('#Dataset').val().split("\n")); 
					}, 10);

		});

		</script>
 	<body>
 	<div id="submiturl"></div>
 	<div style="width:50%">
 	<form id="form" action="/" method="post">
 		<input type="submit" class="try" value="Submit">
		<br/>
		* Catalog Name
 		<br/>
 		<input class="enter" type="text" id="CatalogName"></input>
 		<br/>
		* Catalog ID
 		<br/>
 		<input class="enter" type="text" id="CatalogID"></input>
 		<br/>
		Catalog Description (If not specified, Catalog Name is used.)
 		<br/>
 		<input class="enter" type="text" id="CatalogDescription"></input>
 		<br/>
 		* Column units
 		<br/>
 		<input type="text" id="ColumnUnits"></input>
 		<br/>
 		<br/>
 	<hr/>
		<br/>
 		* Dataset Description, [ID, other info].  (If not specified, ID is generated based on Dataset Description.)
 		<br>
 		<textarea class="enter" id="Dataset"></textarea>
 		<br/>
 		Column labels ($1 refers to DatasetDescription, $2 refers to ID, etc.)
 		<br/>
 		<input type='text' id="ColumnLabels" class="enter"></input>
 		<input type="button" class="try" value="Expand">
 		<br/>
 		<textarea class="try"></textarea>
 		<br/>
 		Column description ($1 refers to DatasetDescription, $2 refers to ID, etc.)
 		<br/>
 		<input type="text" id="ColumnLongnames" class="enter"></input>
		<input type="button" class="try" value="Expand">
 		<br/>
 		<textarea class="try"></textarea>
 		<br/>
 		Column groupings ($1 refers to DatasetDescription, $2 refers to ID, etc.)
 		<br/>
 		<input type="text" id="ColumnGroupings" class="enter"></input>
		<input type="button" class="try" value="Expand">
 		<br/>
 		<textarea class="try"></textarea>
 		<br/>
 		Column group names ($1 refers to DatasetDescription, $2 refers to ID, etc.)
 		<br/>
 		<input type="text" id="ColumnGroupnames" class="enter"></input>
		<input type="button" class="try" value="Expand">
 		<br/>
 		<textarea class="try"></textarea>
 		<br/>
 		Column group types ($1 refers to DatasetDescription, $2 refers to ID, etc.)
 		<br/>
 		<input type='text' id="ColumnGrouptypes" class="enter"></input>
		<input type="button" class="try" value="Expand">
 		<br/>
 		<textarea class="try"></textarea>
 		<br/>
		<br/>
 	<hr/>	
 		<br/>
 		 * Start date min (YYYY-MM-DD)
 		<br/>
 		<input type="text" id="startmin" class="enter"></input>
 		<br/>
 		<div style="display:none;">
	 		Start dates <span id="guessstartnote" style="display:none"></span>
	 		<br/> 		
	 		<textarea id="startdates" class="try"></textarea>
	 		<br/>
	 		<br/>
 		</div> 		
 		* Stop date max 
 		<br/>
	 	<input type="text" id="stopmax" class="enter"></input>
	 	<br/>
 		<div style="display:none;">
	 		Stop dates <span id="guessstopnote" style="display:none"></span>
	 		<br/> 		
	 		<textarea id="stopdates" class="try"></textarea>
	 		<br/> 		
	 		<br/>
 		</div>
 		* URL template ($1 refers to Dataset Description, $2 refers to ID, etc.  %Y = four-digit year, %m = two-digit month, %d = two-digit day.)
 		<br/>
 		<input type="text" id="Template" class="enter"></input>
 		<input type="button" class="try" value="Expand">
 		<br/>
 		Data URLs (Generated by expanding $ wildcards for each Dataset and the % wildcards for entire timerange.) 
 		<br/>
 		<input id="checkdataurls" type="button" onclick="ajaxRequest(this,'HEAD');" value="Do HEAD request for each URL">
 		<span id="checkdataurls_span" style="display:none">
 			<span id="checkdataurls_results"></span>
 		</span>
 		<span id="reportdataurls">
 			<br/>
	 		<input id="reportdataurls" type="button" onclick="ajaxRequest(this,'GET');" value="Do GET request for each URL (slow)">
	 		<span id="reportdataurls_span" style="display:none">
	 			<span id="reportdataurls_results"></span>
	 		</span>
 		</span>
 		<span id="report2dataurls">
 			<br/>
	 		<input id="report2dataurls" type="button" onclick="ajaxReport(this,'report');" value="Generate report on URLs (slow)">
	 		<span id="report2dataurls_span" style="display:none">
	 			<iframe id="report2dataurls_results"></iframe>
	 		</span>
 		</span>
 		<span id="report3dataurls">
 			<br/>
	 		<input id="report3dataurls" type="button" onclick="ajaxReport(this,'plot');" value="Generate plot for each URL (slow)">
	 		<span id="report3dataurls_span" style="display:none">
	 		</span>
 		</span>
 		<br/>
  		<textarea id="urls" class="try" style="display:none"></textarea>
  		<div id="urls" class="try" style="display:none"></div>
 		<br/>
 		<br/>
 		<div id="urlsvalid" style="display:none">
	 		Valid data urls
	 		<br/>
	  		<textarea id="urlsv" class="try"></textarea>
	 		<br/>
	 		<br/>
 		</div>
 		<div id="urlsinvalid" style="display:none">
	 		Invalid data urls
	 		<br/>
	  		<textarea id="urlsi" class="try"></textarea>
	 		<br/>
	 		<br/>
 		</div>
 	<hr/>
		<br/>
 		* Data line regular expression <input id="trydataregex" type="button" class="guessajax" value="Try">
 		<br/>
 		<input type="text" id="LineRegex"></input>
 		<br/>
		* Data Line Template <input id="trydatatemplate" type="button" class="guessajax" value="Try">
  		<input type="text" id="LineTemplate"></input>
		<br/>
		<br/>
 		<div id="dlscript" style="display:none">
	 		Download Script
	 		<br/>
	  		<textarea id="script" class="try"></textarea>
	 		<br/>
	 		<br/>
 		</div>
 	<hr/>	
		<br/> 		
 		<div style="display:none">
			<br/>
			<br/>
			catalog.thredds:
			<br/>
		 	<textarea class="try" id="catalog"></textarea>
			<br/>
		</div>
 	</form>
 	</div>
 	</body>
 </html>